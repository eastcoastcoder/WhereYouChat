{"version":3,"sources":["resources/leaflet.draw/edit/handler/EditToolbar.Delete.js"],"names":["L","EditToolbar","Delete","Handler","extend","statics","TYPE","initialize","map","options","prototype","call","Util","setOptions","_deletableLayers","featureGroup","FeatureGroup","Error","type","version","split","parseInt","include","Evented","Mixin","Events","enable","_enabled","_hasAvailableLayers","fire","handler","_map","Draw","Event","DELETESTART","on","_enableLayerDelete","_disableLayerDelete","disable","off","DELETESTOP","addHooks","getContainer","focus","eachLayer","_deletedLayers","LayerGroup","_tooltip","Tooltip","updateContent","text","drawLocal","edit","handlers","remove","tooltip","_onMouseMove","removeHooks","dispose","revertLayers","layer","addLayer","save","DELETED","layers","removeAllLayers","_removeLayer","e","target","removeLayer","updatePosition","latlng","getLayers","length"],"mappings":"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","file":"EditToolbar.Delete.7954a9de.map","sourceRoot":"..","sourcesContent":["/**\n * @class L.EditToolbar.Delete\n * @aka EditToolbar.Delete\n */\nL.EditToolbar.Delete = L.Handler.extend({\n\tstatics: {\n\t\tTYPE: 'remove' // not delete as delete is reserved in js\n\t},\n\n\t// @method intialize(): void\n\tinitialize: function (map, options) {\n\t\tL.Handler.prototype.initialize.call(this, map);\n\n\t\tL.Util.setOptions(this, options);\n\n\t\t// Store the selectable layer group for ease of access\n\t\tthis._deletableLayers = this.options.featureGroup;\n\n\t\tif (!(this._deletableLayers instanceof L.FeatureGroup)) {\n\t\t\tthrow new Error('options.featureGroup must be a L.FeatureGroup');\n\t\t}\n\n\t\t// Save the type so super can fire, need to do this as cannot do this.TYPE :(\n\t\tthis.type = L.EditToolbar.Delete.TYPE;\n\n\t\tvar version = L.version.split('.');\n\t\t//If Version is >= 1.2.0\n\t\tif (parseInt(version[0], 10) === 1 && parseInt(version[1], 10) >= 2) {\n\t\t\tL.EditToolbar.Delete.include(L.Evented.prototype);\n\t\t} else {\n\t\t\tL.EditToolbar.Delete.include(L.Mixin.Events);\n\t\t}\n\n\t},\n\n\t// @method enable(): void\n\t// Enable the delete toolbar\n\tenable: function () {\n\t\tif (this._enabled || !this._hasAvailableLayers()) {\n\t\t\treturn;\n\t\t}\n\t\tthis.fire('enabled', {handler: this.type});\n\n\t\tthis._map.fire(L.Draw.Event.DELETESTART, {handler: this.type});\n\n\t\tL.Handler.prototype.enable.call(this);\n\n\t\tthis._deletableLayers\n\t\t\t.on('layeradd', this._enableLayerDelete, this)\n\t\t\t.on('layerremove', this._disableLayerDelete, this);\n\t},\n\n\t// @method disable(): void\n\t// Disable the delete toolbar\n\tdisable: function () {\n\t\tif (!this._enabled) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._deletableLayers\n\t\t\t.off('layeradd', this._enableLayerDelete, this)\n\t\t\t.off('layerremove', this._disableLayerDelete, this);\n\n\t\tL.Handler.prototype.disable.call(this);\n\n\t\tthis._map.fire(L.Draw.Event.DELETESTOP, {handler: this.type});\n\n\t\tthis.fire('disabled', {handler: this.type});\n\t},\n\n\t// @method addHooks(): void\n\t// Add listener hooks to this handler\n\taddHooks: function () {\n\t\tvar map = this._map;\n\n\t\tif (map) {\n\t\t\tmap.getContainer().focus();\n\n\t\t\tthis._deletableLayers.eachLayer(this._enableLayerDelete, this);\n\t\t\tthis._deletedLayers = new L.LayerGroup();\n\n\t\t\tthis._tooltip = new L.Draw.Tooltip(this._map);\n\t\t\tthis._tooltip.updateContent({text: L.drawLocal.edit.handlers.remove.tooltip.text});\n\n\t\t\tthis._map.on('mousemove', this._onMouseMove, this);\n\t\t}\n\t},\n\n\t// @method removeHooks(): void\n\t// Remove listener hooks from this handler\n\tremoveHooks: function () {\n\t\tif (this._map) {\n\t\t\tthis._deletableLayers.eachLayer(this._disableLayerDelete, this);\n\t\t\tthis._deletedLayers = null;\n\n\t\t\tthis._tooltip.dispose();\n\t\t\tthis._tooltip = null;\n\n\t\t\tthis._map.off('mousemove', this._onMouseMove, this);\n\t\t}\n\t},\n\n\t// @method revertLayers(): void\n\t// Revert the deleted layers back to their prior state.\n\trevertLayers: function () {\n\t\t// Iterate of the deleted layers and add them back into the featureGroup\n\t\tthis._deletedLayers.eachLayer(function (layer) {\n\t\t\tthis._deletableLayers.addLayer(layer);\n\t\t\tlayer.fire('revert-deleted', {layer: layer});\n\t\t}, this);\n\t},\n\n\t// @method save(): void\n\t// Save deleted layers\n\tsave: function () {\n\t\tthis._map.fire(L.Draw.Event.DELETED, {layers: this._deletedLayers});\n\t},\n\n\t// @method removeAllLayers(): void\n\t// Remove all delateable layers\n\tremoveAllLayers: function () {\n\t\t// Iterate of the delateable layers and add remove them\n\t\tthis._deletableLayers.eachLayer(function (layer) {\n\t\t\tthis._removeLayer({layer: layer});\n\t\t}, this);\n\t\tthis.save();\n\t},\n\n\t_enableLayerDelete: function (e) {\n\t\tvar layer = e.layer || e.target || e;\n\n\t\tlayer.on('click', this._removeLayer, this);\n\t},\n\n\t_disableLayerDelete: function (e) {\n\t\tvar layer = e.layer || e.target || e;\n\n\t\tlayer.off('click', this._removeLayer, this);\n\n\t\t// Remove from the deleted layers so we can't accidentally revert if the user presses cancel\n\t\tthis._deletedLayers.removeLayer(layer);\n\t},\n\n\t_removeLayer: function (e) {\n\t\tvar layer = e.layer || e.target || e;\n\n\t\tthis._deletableLayers.removeLayer(layer);\n\n\t\tthis._deletedLayers.addLayer(layer);\n\n\t\tlayer.fire('deleted');\n\t},\n\n\t_onMouseMove: function (e) {\n\t\tthis._tooltip.updatePosition(e.latlng);\n\t},\n\n\t_hasAvailableLayers: function () {\n\t\treturn this._deletableLayers.getLayers().length !== 0;\n\t}\n});\n"]}