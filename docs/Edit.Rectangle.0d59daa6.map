{"version":3,"sources":["resources/leaflet.draw/edit/handler/Edit.Rectangle.js"],"names":["L","Edit","Rectangle","SimpleShape","extend","_createMoveMarker","bounds","center","_shape","getBounds","getCenter","_moveMarker","_createMarker","options","moveIcon","_createResizeMarker","corners","_getCorners","_resizeMarkers","i","l","length","push","resizeIcon","_cornerIndex","_onMarkerDragStart","e","prototype","call","currentCornerIndex","target","_oppositeCorner","_toggleCornerMarkers","_onMarkerDragEnd","marker","setLatLng","_repositionCornerMarkers","_move","newCenter","latlngs","offset","_defaultShape","getLatLngs","newLatLngs","lat","lng","setLatLngs","_map","fire","Draw","Event","EDITMOVE","layer","_resize","latlng","setBounds","latLngBounds","EDITRESIZE","getNorthWest","getNorthEast","getSouthEast","getSouthWest","opacity","setOpacity","addInitHook","editing","editable","enable"],"mappings":";AAAAA,EAAEC,KAAOD,EAAEC,MAAQ,GAMnBD,EAAEC,KAAKC,UAAYF,EAAEC,KAAKE,YAAYC,OAAO,CAC5CC,kBAAmB,WACdC,IACHC,EADY,KAAKC,OAAOC,YACRC,YAEZC,KAAAA,YAAc,KAAKC,cAAcL,EAAQ,KAAKM,QAAQC,WAG5DC,oBAAqB,WAChBC,IAAAA,EAAU,KAAKC,cAEdC,KAAAA,eAAiB,GAEjB,IAAA,IAAIC,EAAI,EAAGC,EAAIJ,EAAQK,OAAQF,EAAIC,EAAGD,IACrCD,KAAAA,eAAeI,KAAK,KAAKV,cAAcI,EAAQG,GAAI,KAAKN,QAAQU,aAEhEL,KAAAA,eAAeC,GAAGK,aAAeL,GAIxCM,mBAAoB,SAAUC,GAC7B1B,EAAEC,KAAKE,YAAYwB,UAAUF,mBAAmBG,KAAK,KAAMF,GAGvDV,IAAAA,EAAU,KAAKC,cAElBY,EADSH,EAAEI,OACiBN,aAExBO,KAAAA,gBAAkBf,GAASa,EAAqB,GAAK,GAErDG,KAAAA,qBAAqB,EAAGH,IAG9BI,iBAAkB,SAAUP,GACvBQ,IACK3B,EADL2B,EAASR,EAAEI,OAIXI,IAAW,KAAKvB,cAEnBJ,EADS,KAAKC,OAAOC,YACLC,YAEhBwB,EAAOC,UAAU5B,IAGbyB,KAAAA,qBAAqB,GAErBI,KAAAA,2BAELpC,EAAEC,KAAKE,YAAYwB,UAAUM,iBAAiBL,KAAK,KAAMF,IAG1DW,MAAO,SAAUC,GAOX,IANDC,IAGHC,EAHGD,EAAU,KAAK/B,OAAOiC,cAAgB,KAAKjC,OAAOiC,gBAAkB,KAAKjC,OAAOkC,aAEnFnC,EADS,KAAKC,OAAOC,YACLC,YACRiC,EAAa,GAGbxB,EAAI,EAAGC,EAAImB,EAAQlB,OAAQF,EAAIC,EAAGD,IAC1CqB,EAAS,CAACD,EAAQpB,GAAGyB,IAAMrC,EAAOqC,IAAKL,EAAQpB,GAAG0B,IAAMtC,EAAOsC,KAC/DF,EAAWrB,KAAK,CAACgB,EAAUM,IAAMJ,EAAO,GAAIF,EAAUO,IAAML,EAAO,KAG/DhC,KAAAA,OAAOsC,WAAWH,GAGlBP,KAAAA,2BAEAW,KAAAA,KAAKC,KAAKhD,EAAEiD,KAAKC,MAAMC,SAAU,CAACC,MAAO,KAAK5C,UAGpD6C,QAAS,SAAUC,GACdhD,IAAAA,EAGCE,KAAAA,OAAO+C,UAAUvD,EAAEwD,aAAaF,EAAQ,KAAKvB,kBAGlDzB,EAAS,KAAKE,OAAOC,YAChBE,KAAAA,YAAYwB,UAAU7B,EAAOI,aAE7BqC,KAAAA,KAAKC,KAAKhD,EAAEiD,KAAKC,MAAMO,WAAY,CAACL,MAAO,KAAK5C,UAGtDS,YAAa,WACRX,IAAAA,EAAS,KAAKE,OAAOC,YAMlB,MAAA,CALDH,EAAOoD,eACPpD,EAAOqD,eACPrD,EAAOsD,eACPtD,EAAOuD,iBAKd7B,qBAAsB,SAAU8B,GAC1B,IAAA,IAAI3C,EAAI,EAAGC,EAAI,KAAKF,eAAeG,OAAQF,EAAIC,EAAGD,IACjDD,KAAAA,eAAeC,GAAG4C,WAAWD,IAIpC1B,yBAA0B,WAGpB,IAFDpB,IAAAA,EAAU,KAAKC,cAEVE,EAAI,EAAGC,EAAI,KAAKF,eAAeG,OAAQF,EAAIC,EAAGD,IACjDD,KAAAA,eAAeC,GAAGgB,UAAUnB,EAAQG,OAK5CnB,EAAEE,UAAU8D,YAAY,WACnBhE,EAAEC,KAAKC,YACL+D,KAAAA,QAAU,IAAIjE,EAAEC,KAAKC,UAAU,MAEhC,KAAKW,QAAQqD,UACXD,KAAAA,QAAQE","file":"Edit.Rectangle.0d59daa6.map","sourceRoot":"..","sourcesContent":["L.Edit = L.Edit || {};\n/**\n * @class L.Edit.Rectangle\n * @aka Edit.Rectangle\n * @inherits L.Edit.SimpleShape\n */\nL.Edit.Rectangle = L.Edit.SimpleShape.extend({\n\t_createMoveMarker: function () {\n\t\tvar bounds = this._shape.getBounds(),\n\t\t\tcenter = bounds.getCenter();\n\n\t\tthis._moveMarker = this._createMarker(center, this.options.moveIcon);\n\t},\n\n\t_createResizeMarker: function () {\n\t\tvar corners = this._getCorners();\n\n\t\tthis._resizeMarkers = [];\n\n\t\tfor (var i = 0, l = corners.length; i < l; i++) {\n\t\t\tthis._resizeMarkers.push(this._createMarker(corners[i], this.options.resizeIcon));\n\t\t\t// Monkey in the corner index as we will need to know this for dragging\n\t\t\tthis._resizeMarkers[i]._cornerIndex = i;\n\t\t}\n\t},\n\n\t_onMarkerDragStart: function (e) {\n\t\tL.Edit.SimpleShape.prototype._onMarkerDragStart.call(this, e);\n\n\t\t// Save a reference to the opposite point\n\t\tvar corners = this._getCorners(),\n\t\t\tmarker = e.target,\n\t\t\tcurrentCornerIndex = marker._cornerIndex;\n\n\t\tthis._oppositeCorner = corners[(currentCornerIndex + 2) % 4];\n\n\t\tthis._toggleCornerMarkers(0, currentCornerIndex);\n\t},\n\n\t_onMarkerDragEnd: function (e) {\n\t\tvar marker = e.target,\n\t\t\tbounds, center;\n\n\t\t// Reset move marker position to the center\n\t\tif (marker === this._moveMarker) {\n\t\t\tbounds = this._shape.getBounds();\n\t\t\tcenter = bounds.getCenter();\n\n\t\t\tmarker.setLatLng(center);\n\t\t}\n\n\t\tthis._toggleCornerMarkers(1);\n\n\t\tthis._repositionCornerMarkers();\n\n\t\tL.Edit.SimpleShape.prototype._onMarkerDragEnd.call(this, e);\n\t},\n\n\t_move: function (newCenter) {\n\t\tvar latlngs = this._shape._defaultShape ? this._shape._defaultShape() : this._shape.getLatLngs(),\n\t\t\tbounds = this._shape.getBounds(),\n\t\t\tcenter = bounds.getCenter(),\n\t\t\toffset, newLatLngs = [];\n\n\t\t// Offset the latlngs to the new center\n\t\tfor (var i = 0, l = latlngs.length; i < l; i++) {\n\t\t\toffset = [latlngs[i].lat - center.lat, latlngs[i].lng - center.lng];\n\t\t\tnewLatLngs.push([newCenter.lat + offset[0], newCenter.lng + offset[1]]);\n\t\t}\n\n\t\tthis._shape.setLatLngs(newLatLngs);\n\n\t\t// Reposition the resize markers\n\t\tthis._repositionCornerMarkers();\n\n\t\tthis._map.fire(L.Draw.Event.EDITMOVE, {layer: this._shape});\n\t},\n\n\t_resize: function (latlng) {\n\t\tvar bounds;\n\n\t\t// Update the shape based on the current position of this corner and the opposite point\n\t\tthis._shape.setBounds(L.latLngBounds(latlng, this._oppositeCorner));\n\n\t\t// Reposition the move marker\n\t\tbounds = this._shape.getBounds();\n\t\tthis._moveMarker.setLatLng(bounds.getCenter());\n\n\t\tthis._map.fire(L.Draw.Event.EDITRESIZE, {layer: this._shape});\n\t},\n\n\t_getCorners: function () {\n\t\tvar bounds = this._shape.getBounds(),\n\t\t\tnw = bounds.getNorthWest(),\n\t\t\tne = bounds.getNorthEast(),\n\t\t\tse = bounds.getSouthEast(),\n\t\t\tsw = bounds.getSouthWest();\n\n\t\treturn [nw, ne, se, sw];\n\t},\n\n\t_toggleCornerMarkers: function (opacity) {\n\t\tfor (var i = 0, l = this._resizeMarkers.length; i < l; i++) {\n\t\t\tthis._resizeMarkers[i].setOpacity(opacity);\n\t\t}\n\t},\n\n\t_repositionCornerMarkers: function () {\n\t\tvar corners = this._getCorners();\n\n\t\tfor (var i = 0, l = this._resizeMarkers.length; i < l; i++) {\n\t\t\tthis._resizeMarkers[i].setLatLng(corners[i]);\n\t\t}\n\t}\n});\n\nL.Rectangle.addInitHook(function () {\n\tif (L.Edit.Rectangle) {\n\t\tthis.editing = new L.Edit.Rectangle(this);\n\n\t\tif (this.options.editable) {\n\t\t\tthis.editing.enable();\n\t\t}\n\t}\n});\n"]}