{"version":3,"sources":["resources/leaflet.draw/draw/handler/Draw.SimpleShape.js"],"names":["L","SimpleShape","Draw","Feature","extend","options","repeatMode","initialize","map","_endLabelText","drawLocal","draw","handlers","simpleshape","tooltip","end","prototype","call","addHooks","_map","_mapDraggable","dragging","enabled","disable","_container","style","cursor","_tooltip","updateContent","text","_initialLabelText","on","_onMouseDown","_onMouseMove","document","addEventListener","DomEvent","preventDefault","passive","removeHooks","enable","off","_onMouseUp","removeEventListener","_shape","removeLayer","_isDrawing","_getTooltipText","e","_startLatLng","latlng","originalEvent","updatePosition","_drawShape","_fireCreatedEvent"],"mappings":";AAAAA,EAAEC,YAAc,GAMhBD,EAAEE,KAAKD,YAAcD,EAAEE,KAAKC,QAAQC,OAAO,CAC1CC,QAAS,CACRC,YAAY,GAIbC,WAAY,SAAUC,EAAKH,GACrBI,KAAAA,cAAgBT,EAAEU,UAAUC,KAAKC,SAASC,YAAYC,QAAQC,IAEnEf,EAAEE,KAAKC,QAAQa,UAAUT,WAAWU,KAAK,KAAMT,EAAKH,IAKrDa,SAAU,WACTlB,EAAEE,KAAKC,QAAQa,UAAUE,SAASD,KAAK,MACnC,KAAKE,OACHC,KAAAA,cAAgB,KAAKD,KAAKE,SAASC,UAEpC,KAAKF,eACHD,KAAAA,KAAKE,SAASE,UAIfC,KAAAA,WAAWC,MAAMC,OAAS,YAE1BC,KAAAA,SAASC,cAAc,CAACC,KAAM,KAAKC,oBAEnCX,KAAAA,KACHY,GAAG,YAAa,KAAKC,aAAc,MACnCD,GAAG,YAAa,KAAKE,aAAc,MACnCF,GAAG,aAAc,KAAKC,aAAc,MACpCD,GAAG,YAAa,KAAKE,aAAc,MAQrCC,SAASC,iBAAiB,aAAcnC,EAAEoC,SAASC,eAAgB,CAACC,SAAS,MAM/EC,YAAa,WACZvC,EAAEE,KAAKC,QAAQa,UAAUuB,YAAYtB,KAAK,MACtC,KAAKE,OACJ,KAAKC,eACHD,KAAAA,KAAKE,SAASmB,SAIfhB,KAAAA,WAAWC,MAAMC,OAAS,GAE1BP,KAAAA,KACHsB,IAAI,YAAa,KAAKT,aAAc,MACpCS,IAAI,YAAa,KAAKR,aAAc,MACpCQ,IAAI,aAAc,KAAKT,aAAc,MACrCS,IAAI,YAAa,KAAKR,aAAc,MAEtCjC,EAAEoC,SAASK,IAAIP,SAAU,UAAW,KAAKQ,WAAY,MACrD1C,EAAEoC,SAASK,IAAIP,SAAU,WAAY,KAAKQ,WAAY,MAEtDR,SAASS,oBAAoB,aAAc3C,EAAEoC,SAASC,gBAGlD,KAAKO,SACHzB,KAAAA,KAAK0B,YAAY,KAAKD,eACpB,KAAKA,SAGTE,KAAAA,YAAa,GAGnBC,gBAAiB,WACT,MAAA,CACNlB,KAAM,KAAKpB,gBAIbuB,aAAc,SAAUgB,GAClBF,KAAAA,YAAa,EACbG,KAAAA,aAAeD,EAAEE,OAEtBlD,EAAEoC,SACAL,GAAGG,SAAU,UAAW,KAAKQ,WAAY,MACzCX,GAAGG,SAAU,WAAY,KAAKQ,WAAY,MAC1CL,eAAeW,EAAEG,gBAGpBlB,aAAc,SAAUe,GACnBE,IAAAA,EAASF,EAAEE,OAEVvB,KAAAA,SAASyB,eAAeF,GACzB,KAAKJ,aACHnB,KAAAA,SAASC,cAAc,KAAKmB,mBAC5BM,KAAAA,WAAWH,KAIlBR,WAAY,WACP,KAAKE,QACHU,KAAAA,oBAGD/B,KAAAA,UACD,KAAKlB,QAAQC,YACXkC,KAAAA","file":"Draw.SimpleShape.7e95f1b5.map","sourceRoot":"..","sourcesContent":["L.SimpleShape = {};\n/**\n * @class L.Draw.SimpleShape\n * @aka Draw.SimpleShape\n * @inherits L.Draw.Feature\n */\nL.Draw.SimpleShape = L.Draw.Feature.extend({\n\toptions: {\n\t\trepeatMode: false\n\t},\n\n\t// @method initialize(): void\n\tinitialize: function (map, options) {\n\t\tthis._endLabelText = L.drawLocal.draw.handlers.simpleshape.tooltip.end;\n\n\t\tL.Draw.Feature.prototype.initialize.call(this, map, options);\n\t},\n\n\t// @method addHooks(): void\n\t// Add listener hooks to this handler.\n\taddHooks: function () {\n\t\tL.Draw.Feature.prototype.addHooks.call(this);\n\t\tif (this._map) {\n\t\t\tthis._mapDraggable = this._map.dragging.enabled();\n\n\t\t\tif (this._mapDraggable) {\n\t\t\t\tthis._map.dragging.disable();\n\t\t\t}\n\n\t\t\t//TODO refactor: move cursor to styles\n\t\t\tthis._container.style.cursor = 'crosshair';\n\n\t\t\tthis._tooltip.updateContent({text: this._initialLabelText});\n\n\t\t\tthis._map\n\t\t\t\t.on('mousedown', this._onMouseDown, this)\n\t\t\t\t.on('mousemove', this._onMouseMove, this)\n\t\t\t\t.on('touchstart', this._onMouseDown, this)\n\t\t\t\t.on('touchmove', this._onMouseMove, this);\n\n\t\t\t// we should prevent default, otherwise default behavior (scrolling) will fire,\n\t\t\t// and that will cause document.touchend to fire and will stop the drawing\n\t\t\t// (circle, rectangle) in touch mode.\n\t\t\t// (update): we have to send passive now to prevent scroll, because by default it is {passive: true} now, which means,\n\t\t\t// handler can't event.preventDefault\n\t\t\t// check the news https://developers.google.com/web/updates/2016/06/passive-event-listeners\n\t\t\tdocument.addEventListener('touchstart', L.DomEvent.preventDefault, {passive: false});\n\t\t}\n\t},\n\n\t// @method removeHooks(): void\n\t// Remove listener hooks from this handler.\n\tremoveHooks: function () {\n\t\tL.Draw.Feature.prototype.removeHooks.call(this);\n\t\tif (this._map) {\n\t\t\tif (this._mapDraggable) {\n\t\t\t\tthis._map.dragging.enable();\n\t\t\t}\n\n\t\t\t//TODO refactor: move cursor to styles\n\t\t\tthis._container.style.cursor = '';\n\n\t\t\tthis._map\n\t\t\t\t.off('mousedown', this._onMouseDown, this)\n\t\t\t\t.off('mousemove', this._onMouseMove, this)\n\t\t\t\t.off('touchstart', this._onMouseDown, this)\n\t\t\t\t.off('touchmove', this._onMouseMove, this);\n\n\t\t\tL.DomEvent.off(document, 'mouseup', this._onMouseUp, this);\n\t\t\tL.DomEvent.off(document, 'touchend', this._onMouseUp, this);\n\n\t\t\tdocument.removeEventListener('touchstart', L.DomEvent.preventDefault);\n\n\t\t\t// If the box element doesn't exist they must not have moved the mouse, so don't need to destroy/return\n\t\t\tif (this._shape) {\n\t\t\t\tthis._map.removeLayer(this._shape);\n\t\t\t\tdelete this._shape;\n\t\t\t}\n\t\t}\n\t\tthis._isDrawing = false;\n\t},\n\n\t_getTooltipText: function () {\n\t\treturn {\n\t\t\ttext: this._endLabelText\n\t\t};\n\t},\n\n\t_onMouseDown: function (e) {\n\t\tthis._isDrawing = true;\n\t\tthis._startLatLng = e.latlng;\n\n\t\tL.DomEvent\n\t\t\t.on(document, 'mouseup', this._onMouseUp, this)\n\t\t\t.on(document, 'touchend', this._onMouseUp, this)\n\t\t\t.preventDefault(e.originalEvent);\n\t},\n\n\t_onMouseMove: function (e) {\n\t\tvar latlng = e.latlng;\n\n\t\tthis._tooltip.updatePosition(latlng);\n\t\tif (this._isDrawing) {\n\t\t\tthis._tooltip.updateContent(this._getTooltipText());\n\t\t\tthis._drawShape(latlng);\n\t\t}\n\t},\n\n\t_onMouseUp: function () {\n\t\tif (this._shape) {\n\t\t\tthis._fireCreatedEvent();\n\t\t}\n\n\t\tthis.disable();\n\t\tif (this.options.repeatMode) {\n\t\t\tthis.enable();\n\t\t}\n\t}\n});\n"]}